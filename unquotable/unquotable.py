import wmi

print "Searching for vulnerable services..."

controller = wmi.WMI()
svc = controller.Win32_Service()

for service in svc:
	if service.started:
		path = service.PathName.split(".exe")[0]
		if ("\"" not in path) and (" " in path):
			print "Vulnerable service found!"
			print "Service Name: " + service.DisplayName
			print "Service Path: " + service.PathName
			print "Service Privs: " + service.StartName
			print "Service StartMode: " + service.StartMode
			print "Service State: " + service.State
			print "\n"
